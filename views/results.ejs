<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Homepage</title>
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.3/angular.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.3/angular-route.min.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="/css/hexagons.min.css"> 
  <link rel="stylesheet" type="text/css" href="/css/bootstrap-social.css">
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
  <script>
  var data = <%-JSON.stringify(result)%>
  function loading() {
          document.getElementById('results').innerHTML = '<br\><br\><br\><img src="img/loading1.gif" id="image" style="width:150px;height:120px;">';
  }
  function formatting(){
    
    if (data === "invalid"){
      document.getElementById('title').innerHTML = "Please enter a query"
      document.getElementById('rawLink').innerHTML = ""
    }
    else if (data === "onNpm"){
      data = "This module is on Npm but not on Travis"
      document.getElementById('data').innerHTML = data
      document.getElementById('rawLink').innerHTML = ""
    }
    else if (!data){
      data = "There were no matching entries"
      document.getElementById('data').innerHTML = data
      document.getElementById('rawLink').innerHTML = ""
    }
    else {
      document.getElementById('id').innerHTML = data.id
      document.getElementById('slug').innerHTML = data.slug
      if (data.active){
        document.getElementById('active').innerHTML = data.active
      }
      else{
        document.getElementById('active').innerHTML = "module inactive"
      }
      if (data.description){
        document.getElementById('description').innerHTML = data.description
      }
      else{
        document.getElementById('description').innerHTML = "no description provided"
      }
      if (data.last_build_started_at){
        document.getElementById('build').innerHTML = data.last_build_started_at
      }
      else{
        document.getElementById('build').innerHTML = "no build information provided"
      }
      if (data.last_build_state){
        document.getElementById('state').innerHTML = data.last_build_state
      }
      else{
        document.getElementById('state').innerHTML = "state information unavailable"
      }
      if (data.group){
        document.getElementById('group').innerHTML = data.group
      }
      else{
        document.getElementById('group').innerHTML = "no group information provided"
      }
      if (data.language){
        document.getElementById('language').innerHTML = data.language
      }
      else{
        document.getElementById('language').innerHTML = "no language information provided"
      }
        
      document.getElementById('raw').className = "btn btn-link"
    }
    
    /*var resp = "";
    var prop = null;
    for (prop in data) {
      if (typeof(data[prop]) == "object" && data[prop] != null){
        if (data.hasOwnProperty(prop)) {
            resp += prop + " = " + data[prop] + "<br />";
      }
        for (pr in data[prop]){
          var p = data[prop];
          console.log(p);
        if (p.hasOwnProperty(pr)) {
            resp += pr + " = " + p[pr] + "<br />";
            
        }
      }
      }
      else if (data.hasOwnProperty(prop)) {
          resp += prop + " = " + data[prop] + "<br />";
    }
      document.getElementById('data').innerHTML = resp
    }
  }*/
}
function raw(){
  document.getElementById('data').innerHTML = data
}
  </script>
  <style type="text/css">
  #content{
    padding-top:70px;
    width:100%;
    text-align: center;
  }
  #footer{
    position:fixed;
    bottom:0;
    width:100%;
    height:70px;
    text-align: center;
    background-color: #FFFFFF;
  }
#results{
  padding-top:50px;
  width: 700px ;
  margin-bottom: 10px;
  margin-left: auto ;
  margin-right: auto ;
  text-align: left;
}
#list{

  margin-left: auto ;
  margin-right: auto ;
  text-align: left;
}
#rawLink{
  width: 700px ;
  margin-bottom: 80px;
  margin-left: auto ;
  margin-right: auto ;
  text-align: center;
}
  </style>
</head>
<body onload="formatting()">
  
  <div>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <a class="navbar-brand">TravisCI Search</a>
      <ul class="nav navbar-nav">
        <li class="active"><a href="/">Home</a></li>
        <li><a href="/about">About</a></li>
      </ul>
    </div>
  </nav>
    <div class="search" id="content">
      <h1><a href="https://travis-ci.org/"><img src="/img/travis-logo.png" style="width:150px;height:75px;"></a> Search</h1><br>
      <form action="/search" method="POST" >
        <input type="text" name="query" placeholder="Enter module name" style="width:200px;height:40px;"/>
        <input class="btn btn-danger" onclick="this.value='Loading';loading()" id="submit" type="submit" value="Submit" style="width:100px;height:35px;display:inline" />
      </form>
    </div>
  <div class ="results" id="results">
    <p class="lead" id ="title">Search Results for: <em><%= input%></em></p>
    
    <HR>
      
      <a target="_blank" href='<%= github%>' class="btn btn-block btn-social btn-sm btn-github" style="width:131px; float:right;">
      <span class="fa fa-github" ></span> view on github
    </a>
  <p class="lead" id="list">
      <ul class="lead" id="data" style="list-style-type:none;">
                      ID: <li id="id"></li>
                      <span><strong>Slug: </strong><li id="slug"></li></span>
                      <li><strong id="active">Active:</strong></li>
                      <li><strong id="description">Description:</strong></li>
                      <li><strong id="build">Last build on:</strong></li>
                      <li><strong id="state">Last build state:</strong></li>
                      <li><strong id="group">Group:</strong></li>
                      <li><strong id="language">Language:</strong></li>
                    </ul>
                  </p>
      <br><br>
    <br>
    <HR>
    </div>
    <div id="rawLink">
      <p><form action="/raw" method="POST">
        <input class="btn btn-link disabled" id="raw" type="submit" value="The above is just an overview of available data, click here to see the raw information" style="width:500px;height:40px;font-family:helvectica-neue;font-weight:300;color:#888888;" /></p><br></form>

  </div>
  <div id="footer">
    <footer>
      <a href="https://www.linkedin.com/in/matthew-o-connor-8972a985?authType=NAME_SEARCH&authToken=IAWc" class="hb-xs-margin"><span class="hb hb-xs spin-icon"><i class="fa fa-linkedin-square"></i></span></a>
      <a href="https://github.com/matt-oc"><span class="hb hb-xs spin-icon"><i class="fa fa-github-square"></i></span></a>
      <a href="https://www.facebook.com/matthew.oconnor.9847"><span class="hb hb-xs spin-icon"><i class="fa fa-facebook"></i></span></a>
      <a href="https://twitter.com/MattOC1989"><span class="hb hb-xs spin-icon"><i class="fa fa-twitter"></i></span></a>
    </footer>
  </div>
  <script src="/js/jquery-2.1.0.min.js"></script>
  <script src="/js/hexagons.min.js"></script>
</body>
